---
import { getCarImages } from "@/utils";
import ConstructorCard from "../components/ConstructorCard.astro";
import Layout from "../layouts/Layout.astro";
import type { ConstructorName } from "@/types";
import { Image } from "astro:assets";

interface SeasonInfo {
  key: string;
  title: string;
  subtitle: string;
  game: string;
  raceCount: number;
  winners?: string[];
  car?: ConstructorName;
  link?: string;
}

const { images, imagePath } = getCarImages();

const seasonCars: { [key: string]: string[] } = {
  s1: ["ginetta"],
  s2: ["renault", "mercedes", "bmw"],
  s3: ["bmw"],
  s4: [
    "alpine",
    "astonmartin",
    "audi",
    "bmw",
    "chevrolet",
    "ginetta",
    "ktm",
    "maserati",
    "mclaren",
    "mercedes",
    "porsche",
  ],
  s5: [],
};

const seasonInfo: SeasonInfo[] = [
  {
    key: "s1",
    title: "Season 1",
    subtitle: "Ginetta Juniors",
    game: "Project Cars 2",
    raceCount: 6,
    winners: ["Graeme", "Cannon Man Dan", "InkubusJaymz"],
    car: "ginetta",
  },
  {
    key: "s2",
    title: "Season 2",
    link: "/s2",
    subtitle: "Touring Cars",
    game: "Project Cars 2",
    raceCount: 12,
    winners: ["Cannon Man Dan", "Atlas", "Kruthal"],
    car: "bmw",
  },
  {
    key: "s3",
    title: "Season 3",
    link: "/s3",
    subtitle: "TCX",
    game: "ACC",
    raceCount: 10,
    winners: ["N. Bird", "Cousin Bob", "Big Time Bosco"],
    car: "bmw",
  },
  {
    key: "s4",
    title: "Season 4",
    link: "/s4",
    subtitle: "GT4",
    game: "ACC",
    raceCount: 15,
    winners: ["Big Time Bosco", "N. Bird", "Michael Smith"],
    car: "alpine",
  },
  {
    key: "s5",
    title: "Season 5",
    link: "/s5",
    subtitle: "GT3",
    game: "ACC",
    raceCount: 10,
  },
];
---

<Layout title="Inky 500 | Seasons">
  <main>
    <h1>Seasons</h1>
    <div class="grid sm:grid-cols-2 gap-3">
      {
        seasonInfo.map((season) => (
          <ConstructorCard
            title={season.title}
            subtitle={`${season.subtitle} - ${season.raceCount} races`}
            link={season.link}
            car={season.car}
          >
            <div class="flex items-center gap-2 flex-wrap -mt-4 mb-4">
              {seasonCars[season.key].map(
                (car: string) =>
                  images[imagePath(car as ConstructorName)] && (
                    <Image
                      src={images[imagePath(car as ConstructorName)]()}
                      alt={car}
                      class="w-6 h-6"
                    />
                  )
              )}
            </div>
            <div class="flex flex-col gap-2">
              {season.winners ? (
                <>
                  <p>ðŸ¥‡ {season.winners[0]}</p>
                  <p>ðŸ¥ˆ {season.winners[1]}</p>
                  <p>ðŸ¥‰ {season.winners[2]}</p>
                </>
              ) : (
                "IN PROGRESS"
              )}
            </div>
          </ConstructorCard>
        ))
      }
    </div>
  </main>
</Layout>
